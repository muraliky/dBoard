Option Explicit

Sub ClearTable_NoProtection()
    ' --- USER SETTINGS ---
    Const sheetName As String = "Sheet1"   ' change this to your sheet name
    Const startRow As Long = 3              ' first row of your table
    Const endRow As Long = 12               ' last row of your table
    Const firstCol As Long = 2              ' B = 2
    Const lastCol As Long = 8               ' H = 8
    ' ----------------------

    Dim ws As Worksheet
    Dim targetRange As Range
    Dim cell As Range
    Dim masterAddr As String
    Dim clearedMasters As Object
    Dim clearedMergedCount As Long, clearedSingleCount As Long

    On Error GoTo ErrHandler
    Set ws = ThisWorkbook.Worksheets(sheetName)
    Set targetRange = ws.Range(ws.Cells(startRow, firstCol), ws.Cells(endRow, lastCol))
    Set clearedMasters = CreateObject("Scripting.Dictionary")

    Application.ScreenUpdating = False
    Application.EnableEvents = False
    Application.Calculation = xlCalculationManual

    ' Loop through each cell in the target area
    For Each cell In targetRange
        If cell.MergeCells Then
            ' Only clear the top-left cell of each merged area once
            masterAddr = cell.MergeArea.Cells(1, 1).Address(False, False)
            If Not clearedMasters.Exists(masterAddr) Then
                cell.MergeArea.Cells(1, 1).ClearContents
                clearedMasters.Add masterAddr, 1
                clearedMergedCount = clearedMergedCount + 1
            End If
        Else
            ' Not merged — clear directly
            cell.ClearContents
            clearedSingleCount = clearedSingleCount + 1
        End If
    Next cell

    Application.Calculation = xlCalculationAutomatic
    Application.EnableEvents = True
    Application.ScreenUpdating = True

    MsgBox "✅ Cleared data in rows " & startRow & " to " & endRow & vbCrLf & _
           clearedMergedCount & " merged cells cleared" & vbCrLf & _
           clearedSingleCount & " single cells cleared", vbInformation, "Clear Complete"

    Exit Sub

ErrHandler:
    Application.Calculation = xlCalculationAutomatic
    Application.EnableEvents = True
    Application.ScreenUpdating = True
    MsgBox "⚠️ Error " & Err.Number & ": " & Err.Description, vbExclamation, "Error"
End Sub
