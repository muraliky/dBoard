public class SharePointUploader
{
    public async Task UploadAsync(string sharepointFolderUrl, string localFilePath)
    {
        using var playwright = await Playwright.CreateAsync();
        await using var browser = await playwright.Chromium.LaunchAsync(new() { Channel = "msedge", Headless = true });
        var context = await browser.NewContextAsync();
        var page = await context.NewPageAsync();
        await page.GotoAsync(sharepointFolderUrl, new() { WaitUntil = WaitUntilState.NetworkIdle });

        var uploadButton = await page.QuerySelectorAsync("button[aria-label='Upload'], button:has-text('Upload')");
        if (uploadButton != null) { await uploadButton.ClickAsync(); await page.WaitForTimeoutAsync(500); }
        var fileInput = await page.QuerySelectorAsync("input[type='file']");
        if (fileInput == null) throw new Exception("Upload input not found");
        await fileInput.SetInputFilesAsync(localFilePath);
        await page.WaitForSelectorAsync($"text=\"{Path.GetFileName(localFilePath)}\"", new() { Timeout = 60000 });
        await context.CloseAsync();
        await browser.CloseAsync();
    }
}
