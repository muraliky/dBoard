function highlight(s){
  const q = (searchEl.value || '').trim();
  const escapedText = escapeHtml(s || '');
  if (!q) return escapedText;

  try {
    // Escape regex metacharacters in the user's query.
    // This character class does NOT include the problematic sequence `${`.
    const escapedQuery = q.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');

    // Build a case-insensitive RegExp from the escaped query
    const re = new RegExp('(' + escapedQuery + ')', 'ig');

    // Replace matches in the escaped text with a highlight span
    return escapedText.replace(re, '<span class="highlight">$1</span>');
  } catch (e) {
    return escapedText;
  }
}
